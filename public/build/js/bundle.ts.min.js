"use strict";const mobilemenu=document.querySelector("#mobile-menu"),sidebar=document.querySelector(".sidebar"),btnmenux=document.querySelector("#mobile-menux"),barra=document.querySelector(".barra-mobile"),nametop=document.querySelector(".nametop");mobilemenu&&mobilemenu.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),btnmenux&&btnmenux.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),document.querySelector(".sidebartoggle").addEventListener("click",e=>{sidebar&&(null==sidebar||sidebar.classList.toggle("minsidebar")),nametop&&nametop.classList.toggle("noneElement"),$(".btnav").toggleClass("noneElement")});const configdatatables={paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}};function msjAlert(e,t,o){o.insertAdjacentHTML("beforeend",`<div class="alerta alerta__${e}">\n      <p><i class="fa-solid fa-circle-exclamation"></i> ${t}</p></div>`),borrarMsjAlert(o)}function borrarMsjAlert(e){document.querySelector(".alerta")&&setTimeout(()=>{for(;e.firstChild;)e.removeChild(e.firstChild)},5e3)}function msjalertToast(e,t,o){Swal.fire({icon:e,title:t,text:o,toast:!0,position:"top-end",showConfirmButton:!1,timer:2700})}if(document.querySelectorAll(".count-charts").forEach(e=>{var t;e.textContent=(parseInt(e.dataset.num)-e.previousElementSibling.value.length).toString(),null===(t=e.previousElementSibling)||void 0===t||t.addEventListener("input",t=>{if(e.textContent=parseInt(e.dataset.num)-t.target.value.length+"",parseInt(e.dataset.num)-t.target.value.length<=0){let o=t.target.value.slice(0,parseInt(e.dataset.num));t.target.value=o,e.textContent="0"}})}),document.querySelector("#tabulacion")){const e=document.querySelector('#tabulacion input[type="radio"]:checked').nextElementSibling;document.querySelector("."+e.id).style.display="block";const t=document.querySelectorAll(".tabs span"),o=document.querySelectorAll(".paginas");t.forEach(e=>{e.addEventListener("click",e=>{const t=e.target;o.forEach(e=>e.style.display="none"),document.querySelector("."+t.id).style.display="block"})})}var __awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".clientes")){const n=document.querySelector("#crearCliente"),a=document.querySelector("#miDialogoCliente");let i,r,l=0,c=0,d=[];function o(e){e.target!==a&&"salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allclientes",t=yield fetch(e);d=yield t.json(),console.log(d)}catch(e){console.log(e)}})),i=$("#tablaClientes").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCliente"))||void 0===e||e.reset()}(),document.querySelector("#modalCliente").textContent="Crear cliente",document.querySelector("#btnEditarCrearCliente").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaClientes"))||void 0===e||e.addEventListener("click",e=>{var t,n,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarClientes"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarClientes")))&&function(e){var t,n,i,l,u,s,m,v,p;let f=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(f=null===(l=null===(i=e.target.parentElement)||void 0===i?void 0:i.parentElement)||void 0===l?void 0:l.id);c=1,document.querySelector("#modalCliente").textContent="Actualizar cliente",document.querySelector("#btnEditarCrearCliente").value="Actualizar",r=d.find(e=>e.id===f),document.querySelector("#nombre").value=null==r?void 0:r.nombre,document.querySelector("#apellido").value=null==r?void 0:r.apellido,$("#tipodocumento").val(null!==(u=null==r?void 0:r.tipodocumento)&&void 0!==u?u:""),document.querySelector("#identificacion").value=null!==(s=null==r?void 0:r.identificacion)&&void 0!==s?s:"",document.querySelector("#telefono").value=null!==(m=null==r?void 0:r.telefono)&&void 0!==m?m:"",document.querySelector("#email").value=null!==(v=null==r?void 0:r.email)&&void 0!==v?v:"",document.querySelector("#fecha_nacimiento").value=null!==(p=null==r?void 0:r.fecha_nacimiento)&&void 0!==p?p:"",a.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarClientes"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("eliminarClientes")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);l=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el cliente?",text:"El cliente sera eliminado por completo.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCliente",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(l+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCliente"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",r.id),e.append("nombre",$("#nombre").val()),e.append("apellido",$("#apellido").val()),e.append("telefono",$("#telefono").val()),e.append("email",$("#email").val()),e.append("fecha_nacimiento",$("#fecha_nacimiento").val());try{const n="/admin/api/actualizarCliente",c=yield fetch(n,{method:"POST",body:e}),u=yield c.json();if(console.log(u),void 0!==u.exito){msjalertToast("success","¡Éxito!",u.exito[0]),d.forEach(e=>{e.id==r.id&&(e=Object.assign(e,u.cliente[0]))});const e=i.row(l).data();e[1]=$("#nombre").val(),e[2]=$("#apellido").val(),e[3]=$("#telefono").val(),e[4]=$("#email").val(),i.row(l).data(e).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",u.error[0]);a.close(),document.removeEventListener("click",o)}catch(e){console.log(e)}}))}})}})(),function(){var e;if(document.querySelector(".inicio")){const t=null===(e=document.getElementById("chartventas"))||void 0===e?void 0:e.getContext("2d");new Chart(t,{type:"line",data:{labels:["25-8-2024","26-8-2024","27-8-2024","28-8-2024","29-8-2024","30-8-2024","31-8-2024","01-09-2024"],datasets:[{label:"# of Votes",data:[8,9,3,5,8,4,2,5],borderColor:"#7C3AED",backgroundColor:"#00c8c2",tension:.3}]},options:{scales:{y:{beginAtZero:!0}},plugins:{legend:{display:!1}}}})}}();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};!function(){var e,t,o;if(document.querySelector(".empleado")){const a=document.querySelector("#crearempleado"),i=document.getElementById("miDialogoEmpleado"),r=document.getElementById("miDialogoSkills"),l=document.querySelector("#upImage"),c=document.querySelector("#customUpImage"),d=document.querySelector("#imginputfile"),u=document.querySelector("#nombre"),s=document.querySelector("#apellido"),m=document.querySelector("#movil "),v=document.querySelector("#email"),p=document.querySelector("#departamento"),f=document.querySelector("#ciudad"),g=document.querySelector("#direccion"),y=document.querySelector("#perfil");let S,b,h=0,q=0,E=[];function n(e){e.target!==i&&e.target!==r&&"cancelar"!==e.target.value&&"Actualizar"!==e.target.value||(i.close(),null==r||r.close(),document.removeEventListener("click",n))}S=$("#tablaempleados").DataTable(configdatatables),a.addEventListener("click",e=>{q=0,function(){var e;d.src=" ",null===(e=document.querySelector("#formCrearUpdateEmpleado"))||void 0===e||e.reset()}(),document.querySelector("#modalEmpleado").textContent="Crear empleado",document.querySelector("#btnEditarCrearEmpleado").value="Crear",i.showModal(),document.addEventListener("click",n)}),c.addEventListener("click",()=>l.click()),l.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(d.src=t)},e.readAsDataURL(t)}})),null===(e=document.querySelector("#tablaempleados"))||void 0===e||e.addEventListener("click",e=>{var t,o,a,l,c;const y=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarEmpleado"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarEmpleado")))&&function(e){var t,o,a,r,l,c,y,w,x,C,L,_;let k=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(k=null===(r=null===(a=e.target.parentElement)||void 0===a?void 0:a.parentElement)||void 0===r?void 0:r.id);q=1,document.querySelector("#modalEmpleado").textContent="Actualizar Empleado",document.querySelector("#btnEditarCrearEmpleado").value="Actualizar",b=E.find(e=>e.id==k),d.src="/build/img/"+(null==b?void 0:b.img),u.value=null!==(l=null==b?void 0:b.nombre)&&void 0!==l?l:"",s.value=null!==(c=null==b?void 0:b.apellido)&&void 0!==c?c:"",m.value=null!==(y=null==b?void 0:b.movil)&&void 0!==y?y:"",v.value=null!==(w=null==b?void 0:b.email)&&void 0!==w?w:"",p.value=null!==(x=null==b?void 0:b.departamento)&&void 0!==x?x:"",f.value=null!==(C=null==b?void 0:b.ciudad)&&void 0!==C?C:"",g.value=null!==(L=null==b?void 0:b.direccion)&&void 0!==L?L:"",$("#perfil").val(null!==(_=null==b?void 0:b.perfil)&&void 0!==_?_:""),h=S.row(e.target.closest("tr")).index(),i.showModal(),document.addEventListener("click",n)}(e),((null===(a=e.target)||void 0===a?void 0:a.classList.contains("empleadoSkills"))||(null===(l=e.target.parentElement)||void 0===l?void 0:l.classList.contains("empleadoSkills")))&&function(e){var t,o,a;let i=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===e.target.tagName&&(i=null===(a=null===(o=e.target.parentElement)||void 0===o?void 0:o.parentElement)||void 0===a?void 0:a.id);document.querySelectorAll('.inputskills input[type="checkbox"]').forEach(e=>{e.checked=!1}),b=E.find(e=>e.id==i);var l=null==b?void 0:b.idservicios;null==l||l.forEach(e=>{document.querySelector(`input[data-skillid="${e.idservicio}"]`).checked=!0}),null==r||r.showModal(),document.addEventListener("click",n)}(e),((null==y?void 0:y.classList.contains("eliminarEmpleado"))||(null===(c=y.parentElement)||void 0===c?void 0:c.classList.contains("eliminarEmpleado")))&&function(e){let t=e.target.parentElement.id,o=S.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);h=S.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el empleado?",text:"El empleado sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarEmpleado",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(Swal.fire(a.exito[0],"","success")(S).row(h+o.start).remove().draw(),S.page(o.page).draw("page")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateEmpleado"))||void 0===t||t.addEventListener("submit",e=>{var t;if(q){e.preventDefault();var o,n=S.page.info();if(o=b.img,!d.src.includes(b.img)&&(o=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==o.type&&"image/jpeg"!==o.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalerta1"));if(o.size>55e4)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalerta1"))}(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("idempleado",b.id),e.append("img",o),e.append("nombre",u.value),e.append("apellido",s.value),e.append("movil",m.value),e.append("email",v.value),e.append("departamento",p.value),e.append("ciudad",f.value),e.append("direccion",g.value),e.append("perfil",y.value);try{const t="/admin/api/actualizarEmpleado",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();if(void 0!==a.exito){msjalertToast("success","¡Éxito!",a.exito[0]);const e=S.row(h+=n.start).data();e[1]=u.value+" "+s.value,e[2]=`<div class="text-center"><img style="width: 40px;" src="/build/img/${a.rutaimg[0]}" alt=""></div>`,e[3]=m.value,e[4]=v.value,e[5]=" ",e[6]="1"===y.value?"Empleado":"2"==y.value?"Admin":"Propietario",S.row(h).data(e).draw(),S.page(n.page).draw("page")}else msjalertToast("error","¡Error!",a.exito[0])}catch(e){console.log(e)}}))})()}}),null===(o=document.querySelector("#formSkills"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault();var t=[];document.querySelectorAll('.inputskills input[type="checkbox"]').forEach(e=>{e.checked&&(t=[...t,e.value])}),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("idempleado",b.id),e.append("idservicio",t.toString());try{const o="/admin/api/actualizarSkillsEmpleado",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),E.forEach(e=>{if(e.id==b.id)for(let o=0;o<t.length;o++)e.idservicios=[...e.idservicios,{idempleado:b.id,idservicio:t[o]}]})):msjalertToast("error","¡Error!",a.exito[0])}catch(e){console.log(e)}}))})()})}}();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".testimoniales")){const n=document.querySelector("#crearTestimonial"),a=document.querySelector("#miDialogoTestimonial");let i,r,l=0,c=0,d=[];function o(e){e.target!==a&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/alltestimoniales",t=yield fetch(e);d=yield t.json()}catch(e){console.log(e)}})),i=$("#tablaTestimoniales").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateTestimonial"))||void 0===e||e.reset()}(),document.querySelector("#modalTestimonial").textContent="Crear Testimonial",document.querySelector("#btnEditarCreartestimonial").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaTestimoniales"))||void 0===e||e.addEventListener("click",e=>{var t,n,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarTestimonial"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarTestimonial")))&&function(e){var t,n,u,s;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);c=1,document.querySelector("#modalTestimonial").textContent="Actualizar Testimonio",document.querySelector("#btnEditarCreartestimonial").value="Actualizar",r=d.find(e=>e.id===m),document.querySelector("#nombre").value=null==r?void 0:r.nombre,document.querySelector("#titulo").value=null==r?void 0:r.titulo,document.querySelector("#comentario").value=null==r?void 0:r.comentario,document.querySelector("#email").value=null==r?void 0:r.email,l=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarTsetimonial"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("eliminarTsetimonial")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);l=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el testimonial",text:"Se eliminara por completo el testimonial",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){(new FormData).append("id",t);try{const e="/admin/api/eliminarTsetimonial?id="+t,n=yield fetch(e),a=yield n.json();void 0!==a.exito?(i.row(l+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateTestimonial"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",r.id),e.append("nombre",$("#nombre").val()),e.append("titulo",$("#titulo").val()),e.append("comentario",$("#comentario").val()),e.append("email",$("#email").val());try{const n="/admin/api/editarTestimonial",a=yield fetch(n,{method:"POST",body:e}),c=yield a.json();if(void 0!==c.exito){msjalertToast("success","¡Éxito!",c.exito[0]),d.forEach(e=>{e.id==r.id&&(e=Object.assign(e,c.testimonial[0]))});const e=i.row(l+=t.start).data();e[1]=$("#nombre").val(),e[2]=$("#titulo").val(),e[3]=$("#comentario").val(),e[4]=$("#email").val(),i.row(l).data(e).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",c.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o,n,a;if(document.querySelector(".ventas")){const v=document.querySelector("#addcliente"),p=document.querySelector("#adddir"),f=document.querySelector("#selectCliente"),g=document.querySelector("#direccionEntrega"),y=(document.querySelectorAll("#producto"),document.querySelector("#productos")),S=document.querySelector("#btndescuento"),b=document.querySelector("#btnEntrega"),h=document.querySelector("#modalidadEntrega"),q=document.querySelector("#totalunidades"),E=document.querySelector("#tablaventa tbody"),w=document.querySelector("#btnvaciar"),x=document.querySelector("#btnguardar"),C=document.querySelector("#btnfacturar"),L=document.querySelector("#miDialogoAddCliente"),_=document.querySelector("#miDialogoAddDir"),k=document.querySelector("#miDialogoDescuento"),j=document.querySelector("#miDialogoVaciar"),T=document.querySelector("#miDialogoGuardar"),D=document.querySelector("#miDialogoFacturar"),A=document.querySelector("#caja"),B=document.querySelector("#facturador"),I=document.querySelectorAll(".mediopago"),N=document.querySelectorAll('input[name="tipodescuento"]'),M=document.querySelector("#inputDescuento");let P=[];const O={subtotal:0,impuesto:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0};let z,F=[],Y="",U=0,G=[];const R=new Map;function i(e){for(;null==g?void 0:g.firstChild;)g.removeChild(null==g?void 0:g.firstChild);const t=new Set;F.length=0,e.forEach(e=>{const o=document.createElement("option");o.textContent=e.direccion,o.value=e.id,o.dataset.idcliente=e.idcliente,o.dataset.idtarifa=e.idtarifa,o.dataset.ciudad=e.ciudad,g.appendChild(o),e.tarifa.idcliente=e.idcliente,t.has(e.tarifa.id)||(F=[...F,e.tarifa],t.add(e.tarifa.id))}),t.clear(),r(),c(),document.querySelector("#ciudadEntrega").value=e[0].ciudad}function r(){const e=g.options[g.selectedIndex];if(": Presencial"==h.textContent||-1==g.selectedIndex)return O.valortarifa=0,void(Y="");if((null==e?void 0:e.dataset.idtarifa)&&": Domicilio"==h.textContent){const t=F.find(t=>{if(t.idcliente==e.dataset.idcliente&&t.id==e.dataset.idtarifa)return!0});O.valortarifa=Number(null==t?void 0:t.valor),O.idtarifa=Number(null==t?void 0:t.id),Y=null==t?void 0:t.nombre}}function l(e,t,o){var n,a;const i=P.findIndex(t=>t.idproducto==e);if(i>-1){if(0==t)return void(P[i].cantidad=1);o?P[i].cantidad+=t:P[i].cantidad=t,P[i].total=parseInt(P[i].valorunidad)*P[i].cantidad,c(),(null==E?void 0:E.querySelector(`TR[data-id="${e}"] .inputcantidad`)).value=P[i].cantidad+"",(null===(a=null===(n=null==E?void 0:E.querySelector(`TR[data-id="${e}"]`))||void 0===n?void 0:n.children)||void 0===a?void 0:a[3]).textContent="$"+P[i].total.toLocaleString()}else{const t=G.find(t=>t.id==e),o={idproducto:null==t?void 0:t.id,idcategoria:t.idcategoria,nombreproducto:t.nombre,valorunidad:t.precio_venta,cantidad:1,subtotal:0,impuesto:0,descuento:0,total:Number(t.precio_venta)};P=[...P,o],c(),function(e){z=G.find(t=>t.id==e);const t=document.createElement("TR");t.classList.add("productselect"),t.dataset.id=""+e,t.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==z?void 0:z.nombre}</td> \n      <td class="!px-0 !py-2"><div class="flex"><button><span class="menos material-symbols-outlined">remove</span></button><input type="text" class="inputcantidad w-20 px-2 text-center" value="1" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||1)"><button><span class="mas material-symbols-outlined">add</span></button></div></td>\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==z?void 0:z.precio_venta).toLocaleString()}</td>\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==z?void 0:z.precio_venta).toLocaleString()}</td>\n      <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarEmpleado"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==E||E.appendChild(t)}(e)}}function c(){O.subtotal=P.reduce((e,t)=>t.total+e,0),O.total=O.subtotal+O.valortarifa-O.descuento,document.querySelector("#subTotal").textContent="$"+O.subtotal.toLocaleString(),document.querySelector("#valorTarifa").textContent="$"+O.valortarifa.toLocaleString(),document.querySelector("#total").textContent="$ "+O.total.toLocaleString(),q.textContent=P.reduce((e,t)=>t.cantidad+e,0)+""}function d(e){e=e.replace(/[,.]/g,""),Number(e)>R.get("1")?document.querySelector("#cambio").textContent=(Number(e)-R.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function u(e){const t=e.target;(t===k||t===j||t===T||t===D||t===L||t===_||t.closest(".salir")||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".noguardar")||t.closest(".siguardar")||"Cancelar"==t.value)&&(k.close(),j.close(),T.close(),D.close(),L.close(),_.close(),document.removeEventListener("click",u),t.closest(".siguardar")&&m("Guardado","1"),t.closest(".sivaciar")&&s())}function s(){for(R.clear(),$(".mediopago").val(0),P.length=0;null==E?void 0:E.firstChild;)E.removeChild(null==E?void 0:E.firstChild);document.querySelector("#subTotal").textContent="$0",document.querySelector("#descuento").textContent="$0",document.querySelector("#total").textContent="$0",$("#selectCliente").val(1).trigger("change");for(const e in O)O[e]=0}function m(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("idcliente",document.querySelector("#selectCliente").value),o.append("idvendedor",document.querySelector("#vendedor").dataset.idvendedor),o.append("idcaja",A.value),o.append("idconsecutivo",B.value),o.append("iddireccion",g.value),o.append("idtarifazona",O.idtarifa+""),o.append("cliente",f.options[f.selectedIndex].textContent),o.append("vendedor",document.querySelector("#vendedor").value),o.append("caja",document.querySelector("#caja option:checked").textContent),o.append("tipofacturador",B.options[B.selectedIndex].textContent),o.append("direccion",g.options[g.selectedIndex].text),o.append("tarifazona",Y||""),o.append("carrito",JSON.stringify(P)),o.append("totalunidades",q.textContent),o.append("mediosPago",JSON.stringify(Array.from(R,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),o.append("recibido",document.querySelector("#recibio").value),o.append("transaccion",""),o.append("cotizacion",t),o.append("estado",e),o.append("subtotal",O.subtotal+""),o.append("impuesto",O.impuesto+""),o.append("dctox100",O.dctox100+""),o.append("descuento",O.descuento+""),o.append("total",O.total.toString()),o.append("observacion",document.querySelector("#observacion").value),o.append("departamento",""),o.append("ciudad",document.querySelector("#ciudadEntrega").value),o.append("entrega",h.textContent.replace(": ","")),o.append("valortarifa",O.valortarifa+""),o.append("opc1",""),o.append("opc2","");try{const e="/admin/api/facturar",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();console.log(n),void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),s()):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}D.close(),document.removeEventListener("click",u)}))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e);G=yield t.json(),console.log(G)}catch(e){console.log(e)}})),null==v||v.addEventListener("click",e=>{L.showModal(),document.addEventListener("click",u)}),null==p||p.addEventListener("click",e=>{_.showModal(),document.addEventListener("click",u)}),null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("nombre",document.querySelector("#nombreclientenuevo").value),e.append("apellido",document.querySelector("#clientenuevoapellido").value),e.append("tipodocumento",document.querySelector("#tipodocumento").value),e.append("identificacion",document.querySelector("#identificacion").value),e.append("telefono",document.querySelector("#telefono").value),e.append("email",document.querySelector("#clientenuevoemail").value),e.append("idtarifa",document.querySelector("#clientenuevotarifa").value),e.append("direccion",document.querySelector("#clientenuevodireccion").value),e.append("departamento",document.querySelector("#departamento").value),e.append("ciudad",document.querySelector("#ciudad").value);try{const t="/admin/api/apiCrearCliente",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),function(e){const t=document.createElement("option");t.textContent=document.querySelector("#nombreclientenuevo").value+" "+document.querySelector("#clientenuevoapellido").value,t.value=e,t.dataset.tipodocumento=document.querySelector("#tipodocumento").value,t.dataset.identidad=document.querySelector("#identificacion").value,null==f||f.appendChild(t),$("#selectCliente").val(e).trigger("change")}(n.nextID),function(){var e;null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.reset()}()):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}})),L.close(),document.removeEventListener("click",u)}),$("#selectCliente").on("change",e=>{const t=e.target.value;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e);i(yield o.json())}catch(e){console.log(e)}}));const o=e.target,n=o.options[o.selectedIndex].dataset.identidad||"";document.querySelector("#documento").value=n}),null==g||g.addEventListener("change",e=>{const t=e.target,o=t.options[t.selectedIndex].dataset.ciudad||"";document.querySelector("#ciudadEntrega").value=o,r(),c()}),null===(t=document.querySelector("#formAddDir"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault(),__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("idcliente",f.value),e.append("departamento",document.querySelector("#adddepartamento").value),e.append("ciudad",document.querySelector("#addciudad").value),e.append("direccion",document.querySelector("#adddireccion").value),e.append("idtarifa",document.querySelector("#tarifa").value);try{const t="/admin/api/addDireccionCliente",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),i(n.direcciones)):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}})),_.close(),document.removeEventListener("click",u)}),null==b||b.addEventListener("click",e=>{": Presencial"==h.textContent?h.textContent=": Domicilio":h.textContent=": Presencial",r(),c()}),null==y||y.addEventListener("click",e=>{var t;const o=null===(t=e.target)||void 0===t?void 0:t.closest(".producto");o&&l(o.dataset.id,1,!0)}),null==E||E.addEventListener("click",e=>{var t,o,n;const a=(null===(t=e.target)||void 0===t?void 0:t.closest(".productselect")).dataset.id;if(e.target.classList.contains("menos")){const e=P.find(e=>e.idproducto==a);l(a,e.cantidad-1,!1)}if(e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(o=e.target)||void 0===o||o.addEventListener("input",e=>{l(a,Number(e.target.value),!1)}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")){const e=P.find(e=>e.idproducto==a);l(a,e.cantidad+1,!1)}(e.target.classList.contains("eliminarEmpleado")||"I"==e.target.tagName)&&(P=P.filter(e=>e.idproducto!=a),c(),null===(n=null==E?void 0:E.querySelector(`TR[data-id="${a}"]`))||void 0===n||n.remove())}),null==S||S.addEventListener("click",()=>{P.length&&(U=O.subtotal,k.showModal(),document.addEventListener("click",u))}),null==w||w.addEventListener("click",()=>{P.length&&(j.showModal(),document.addEventListener("click",u))}),null==x||x.addEventListener("click",()=>{P.length&&(T.showModal(),document.addEventListener("click",u))}),null==C||C.addEventListener("click",()=>{": Domicilio"!==h.textContent||"1"!=f.value&&"2"!=f.value&&g.value?P.length&&(!function(){document.querySelector("#totalPagar").textContent=""+O.total.toLocaleString();let e=0;I.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),O.total<e&&(e=0,R.clear(),$(".mediopago").val(0));document.querySelector(".Efectivo").value=""+(O.total-e),R.set("1",O.total-e),O.total-e==0&&R.has("1")&&R.delete("1");d(document.querySelector("#recibio").value)}(),D.showModal(),document.addEventListener("click",u)):msjAlert("error","Cliente o direccion no seleccionado",document.querySelector("#divmsjalerta1"))}),N.forEach(e=>{e.addEventListener("change",e=>{"porcentaje"===e.target.value&&(U=100,M.value=""),"valor"===e.target.value&&(M.value="",U=O.subtotal)})}),null==M||M.addEventListener("input",e=>{var t=Number(e.target.value);t>U&&(M.value=U+"",t=U)}),null===(o=document.querySelector("#formDescuento"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault();const t=Number(M.value);N[0].checked&&(O.dctox100=Math.round(100*t/O.subtotal),O.descuento=t),N[1].checked&&(O.descuento=O.subtotal*t/100,O.dctox100=t),O.total=O.subtotal-O.descuento+O.valortarifa,document.querySelector("#total").textContent="$ "+O.total.toLocaleString(),document.querySelector("#descuento").textContent="$"+O.descuento.toLocaleString(),k.close(),document.removeEventListener("click",u)}),I.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;I.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=O.total?(R.set("1",O.total-o),O.total-o==0&&R.has("1")&&R.delete("1"),R.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&R.has(e.target.id)&&R.delete(e.target.id)):R.has(e.target.id)?e.target.value=R.get(e.target.id).toLocaleString():e.target.value="0";I[0].value=null!==(t=R.get("1"))&&void 0!==t?t:0,d(document.querySelector("#recibio").value)}(e)})}),null===(n=document.querySelector("#recibio"))||void 0===n||n.addEventListener("input",e=>{d(e.target.value)}),null===(a=document.querySelector("#formfacturar"))||void 0===a||a.addEventListener("submit",e=>{e.preventDefault(),m("Paga","0")})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".block")){const n=document.querySelector("#miDialogoBloque");let a,i,r=0,l=0,c=[];function o(e){e.target!==n&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(n.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allblocks",t=yield fetch(e);c=yield t.json()}catch(e){console.log(e)}})),a=$("#tablaBloques").DataTable(configdatatables),null===(e=document.querySelector("#tablaBloques"))||void 0===e||e.addEventListener("click",e=>{var t,d,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarBloque"))||(null===(d=e.target.parentElement)||void 0===d?void 0:d.classList.contains("editarBloque")))&&function(e){var t,d,u,s;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(d=e.target)||void 0===d?void 0:d.tagName)&&(m=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);l=1,document.querySelector("#modalBloque").textContent="Actualizar Contenido",document.querySelector("#btnEditarCrearBloque").value="Actualizar",i=c.find(e=>e.id===m),document.querySelector("#contenido").value=null==i?void 0:i.contenido,r=a.row(e.target.closest("tr")).index(),n.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("bloquearBloque"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("bloquearBloque")))&&function(e){var t;let o,n,i=e.target.parentElement.id,l=a.page.info();"I"===e.target.tagName&&(i=e.target.parentElement.parentElement.id);r=a.row(e.target.closest("tr")).index(),(null===(t=e.target.closest("button"))||void 0===t?void 0:t.classList.contains("btn-red"))?(o="Desea ocultar el contenido?",n="El contenido sera ocultado en la pagina web."):(o="Desea mostrar el contenido?",n="El contenido sera visible en la pagina web.");Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:o,text:n,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){(new FormData).append("id",i);try{const e="/admin/api/bloquearBloque?id="+i,t=yield fetch(e),o=yield t.json();if(void 0!==o.exito){const e=a.row(r+=l.start).data();e[2]="1"===o.bloque[0].estado?"Activo":"Inactivo",e[4]=`<div class="acciones-btns" id="${o.bloque[0].id}">\n                                              <button class="btn-md btn-turquoise editarBloque"><i class="fa-solid fa-pen-to-square"></i></button>\n                                              <button class="btn-md ${"1"===o.bloque[0].estado?"btn-red":"btn-lima"} bloquearBloque"><i class="fa-solid fa-ban"></i></button>\n                                            </div>`,a.row(r).data(e).draw(),a.page(l.page).draw("page"),Swal.fire(o.exito[0],"","success")}else Swal.fire(o.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdatebloque"))||void 0===t||t.addEventListener("submit",e=>{if(l){e.preventDefault();var t=a.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",i.id),e.append("contenido",$("#contenido").val());try{const n="/admin/api/editarBloque",l=yield fetch(n,{method:"POST",body:e}),d=yield l.json();if(void 0!==d.exito){msjalertToast("success","¡Éxito!",d.exito[0]),c.forEach(e=>{e.id==i.id&&(e=Object.assign(e,d.bloque[0]))});const e=a.row(r+=t.start).data();e[2]=$("#contenido").val(),a.row(r).data(e).draw(),a.page(t.page).draw("page")}else msjalertToast("error","¡Error!",d.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".secciones")){const n=document.querySelector("#crearSeccion"),a=document.querySelector("#miDialogoSeccion");let i,r,l=0,c=0,d=[];function o(e){e.target!==a&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allsections",t=yield fetch(e);d=yield t.json()}catch(e){console.log(e)}})),i=$("#tablaSecciones").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateseccion"))||void 0===e||e.reset()}(),document.querySelector("#modalSeccion").textContent="Crear Seccion",document.querySelector("#btnEditarCrearSeccion").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaSecciones"))||void 0===e||e.addEventListener("click",e=>{var t,n,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarSeccion"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarSeccion")))&&function(e){var t,n,u,s;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);c=1,document.querySelector("#modalSeccion").textContent="Actualizar seccion",document.querySelector("#btnEditarCrearSeccion").value="Actualizar",r=d.find(e=>e.id===m),document.querySelector("#nombre").value=null==r?void 0:r.nombre,l=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("bloquearSeccion"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("bloquearSeccion")))&&function(e){var t;let o,n,a=e.target.parentElement.id,r=i.page.info();"I"===e.target.tagName&&(a=e.target.parentElement.parentElement.id);l=i.row(e.target.closest("tr")).index(),(null===(t=e.target.closest("button"))||void 0===t?void 0:t.classList.contains("btn-red"))?(o="Desea bloquear la seccion?",n="La seccion se bloqueara y no sera mostrada en la pagina web."):(o="Desea desbloquear la seccion?",n="La seccion se desbloqueara y sera mostrada en la pagina web.");Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:o,text:n,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){(new FormData).append("id",a);try{const e="/admin/api/bloquearseccion?id="+a,t=yield fetch(e),o=yield t.json();if(void 0!==o.exito){const e=i.row(l+=r.start).data();e[2]="1"===o.seccion[0].estado?"Activo":"Inactivo",e[4]=`<div class="acciones-btns" id="${o.seccion[0].id}">\n                                              <button class="btn-md btn-turquoise editarSeccion"><i class="fa-solid fa-pen-to-square"></i></button>\n                                              <a href="/admin/secciones/seccion?id=${o.seccion[0].id}" class="btn-md btn-blue editarContenidoSeccion"><i class="fa-solid fa-grip-vertical"></i></a>\n                                              <button class="btn-md ${"1"===o.seccion[0].estado?"btn-red":"btn-lima"} bloquearSeccion"><i class="fa-solid fa-ban"></i></button>\n                                            </div>`,i.row(l).data(e).draw(),i.page(r.page).draw("page"),Swal.fire(o.exito[0],"","success")}else Swal.fire(o.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateseccion"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",r.id),e.append("nombre",$("#nombre").val());try{const n="/admin/api/editarseccion",a=yield fetch(n,{method:"POST",body:e}),c=yield a.json();if(void 0!==c.exito){msjalertToast("success","¡Éxito!",c.exito[0]),d.forEach(e=>{e.id==r.id&&(e=Object.assign(e,c.seccion[0]))});const e=i.row(l+=t.start).data();e[1]=$("#nombre").val(),i.row(l).data(e).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",c.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".serviciosadicionales")){const n=document.querySelector("#crearServicioAdicional"),a=document.querySelector("#miDialogoServicio");let i,r,l=0,c=0,d=[];function o(e){e.target!==a&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allserviciosadicionales",t=yield fetch(e);d=yield t.json()}catch(e){console.log(e)}})),i=$("#tablaServiciosAdicionales").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateServicio"))||void 0===e||e.reset()}(),document.querySelector("#modalServicio").textContent="Crear Servicio",document.querySelector("#btnEditarCrearServicio").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaServiciosAdicionales"))||void 0===e||e.addEventListener("click",e=>{var t,n,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarServicio"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarServicio")))&&function(e){var t,n,u,s;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);c=1,document.querySelector("#modalServicio").textContent="Actualizar Servicio",document.querySelector("#btnEditarCrearServicio").value="Actualizar",r=d.find(e=>e.id===m),document.querySelector("#titulo").value=null==r?void 0:r.titulo,document.querySelector("#contenido").value=null==r?void 0:r.contenido,document.querySelector("#textobtn").value=null==r?void 0:r.textobtn,l=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarServicio"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("eliminarServicio")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);l=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el servicio adicional",text:"Se eliminara por completo el servicio adicional",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){(new FormData).append("id",t);try{const e="/admin/api/eliminarServicio?id="+t,n=yield fetch(e),a=yield n.json();void 0!==a.exito?(i.row(l+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateServicio"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",r.id),e.append("titulo",$("#titulo").val()),e.append("contenido",$("#contenido").val()),e.append("textobtn",$("#textobtn").val());try{const n="/admin/api/editarServicio",a=yield fetch(n,{method:"POST",body:e}),c=yield a.json();if(void 0!==c.exito){msjalertToast("success","¡Éxito!",c.exito[0]),d.forEach(e=>{e.id==r.id&&(e=Object.assign(e,c.serviciosadicionales[0]))});const e=i.row(l+=t.start).data();e[1]=$("#titulo").val(),e[2]=$("#contenido").val(),e[3]=$("#textobtn").val(),i.row(l).data(e).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",c.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})(),(()=>{if(document.querySelector(".caja")){const t=document.querySelector("#gastosIngresos"),o=document.querySelector("#btnGastosingresos"),n=document.querySelector("#operacion");function e(o){o.target!==t&&"cancelar"!==o.target.value||(t.close(),document.removeEventListener("click",e))}null==o||o.addEventListener("click",()=>{t.showModal(),document.addEventListener("click",e)}),null==n||n.addEventListener("change",e=>{var t,o;const n=e.target,a=document.querySelector(".tipodegasto");"gasto"==n.value?(a.style.display="flex",null===(t=document.querySelector("#tipodegasto"))||void 0===t||t.setAttribute("required","")):(a.style.display="none",null===(o=document.querySelector("#tipodegasto"))||void 0===o||o.removeAttribute("required"))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".cerrarcaja")){const t=document.querySelector("#modalArqueocaja"),o=document.querySelector("#Modalcerrarcaja"),n=document.querySelector("#btnArqueocaja"),a=document.querySelector("#btnCerrarcaja"),i=document.querySelectorAll(".inputmediopago"),r=document.querySelector("#formArqueocaja");function e(n){(n.target===t||n.target===o||"cancelar"===n.target.value||n.target.closest(".salircerrarcaja")||n.target.closest(".finCerrarcaja"))&&(t.close(),o.close(),document.removeEventListener("click",e),n.target.closest(".finCerrarcaja")&&function(){var t;const n=new FormData;n.append("idcierrecaja",null===(t=document.querySelector("#idCierrecaja"))||void 0===t?void 0:t.textContent),document.querySelector(".content-spinner1").style.display="grid",o.close(),document.removeEventListener("click",e),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/cierrecajaconfirmado",t=yield fetch(e,{method:"POST",body:n}),o=yield t.json();void 0!==o.exito?(document.querySelector(".content-spinner1").style.display="none",msjalertToast("success","¡Éxito!",o.exito[0])):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}}))})()}())}null==n||n.addEventListener("click",()=>{t.showModal(),document.addEventListener("click",e)}),null==a||a.addEventListener("click",()=>{o.showModal(),document.addEventListener("click",e)}),null==r||r.addEventListener("submit",o=>{o.preventDefault(),function(){const e=document.querySelector("#EF"),t=Array.from(document.querySelectorAll(".denominacion")).reduce((e,t)=>Number(t.dataset.moneda)*Number(t.value)+e,0);e.value=t+"";const o=new Event("input");e.dispatchEvent(o)}();const n=new FormData(r);__awaiter(void 0,void 0,void 0,(function*(){try{const o="/admin/api/arqueocaja",a=yield fetch(o,{method:"POST",body:n}),i=yield a.json();void 0!==i.exito?(t.close(),document.removeEventListener("click",e),msjalertToast("success","¡Éxito!",i.exito[0])):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))}),i.forEach(e=>{e.addEventListener("input",e=>{const t=e.target;__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id_mediopago",t.dataset.idmediopago+""),e.append("nombremediopago",t.name),e.append("valordeclarado",t.value);try{const o="/admin/api/declaracionDinero",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(t.style.color="#02db02",t.style.fontWeight="500",function(e,t,o){var n,a;const i=document.querySelector(`.coldeclarado[data-mediopagoid="${e}"]`);if(i){const e=i.nextElementSibling;i.textContent=Number(t).toLocaleString("es-ES",{useGrouping:!0});const o=null===(a=null===(n=i.previousElementSibling)||void 0===n?void 0:n.textContent)||void 0===a?void 0:a.replace(/[.,]/g,"");e.textContent=(Number(t)-Number(o)).toLocaleString("es-ES",{useGrouping:!0})}else{const n=document.querySelector(".cuerpoanalisis");null==n||n.insertAdjacentHTML("beforeend",`\n          <tr class="${"Efectivo"==o?"!border-2 !border-indigo-600":""}">\n            <td class="">${o}</td> \n            <td class="colsistem">0</td>\n            <td class="coldeclarado" data-mediopagoid="${e}">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n            <td class="coldif">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n          </tr>`)}}(t.dataset.idmediopago,t.value,t.name)):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function l(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o,n,a;if(document.querySelector(".ordenresumen")){const l=document.querySelector("#miDialogoFacturar"),c=document.querySelector("#miDialogoEliminarOrden"),d=document.querySelector("#btnfacturar"),u=document.querySelector("#btneliminarorden"),s=document.querySelector("#caja"),m=document.querySelector("#facturador"),v=document.querySelectorAll(".mediopago"),p=document.querySelectorAll('input[name="devolverinventario"]'),f=document.querySelectorAll(".inputInv"),g={subtotal:0,impuesto:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0},y=new Map;function i(e){e=e.replace(/[,.]/g,""),Number(e)>y.get("1")?document.querySelector("#cambio").textContent=(Number(e)-y.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function r(e){const t=e.target;(e.target===l||e.target===c||"cancelar"===e.target.value||t.closest(".noeliminar")||t.closest(".sieliminar"))&&(l.close(),c.close(),t.closest(".sieliminar")&&function(){var e=[];f.forEach(t=>{const o=t;e=[...e,{id:o.id,stock:o.value}]}),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("id",document.querySelector("#idorden").dataset.idorden),t.append("inv",JSON.stringify(e)),t.append("devolverinv","1");try{const e="/admin/api/eliminarOrden",o=yield fetch(e,{method:"POST",body:t}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),u.style.display="none",document.querySelector("#estadoOrden").textContent="Eliminada"):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}(),document.removeEventListener("click",r))}g.subtotal=Number(null===(e=document.querySelector("#subTotal"))||void 0===e?void 0:e.textContent),g.total=Number(null===(o=null===(t=document.querySelector("#total"))||void 0===t?void 0:t.textContent)||void 0===o?void 0:o.replace(/[^\d]/g,"")),null==d||d.addEventListener("click",()=>{!function(){document.querySelector("#totalPagar").textContent=""+g.total.toLocaleString();let e=0;v.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),g.total<e&&(e=0,y.clear(),$(".mediopago").val(0));document.querySelector(".Efectivo").value=""+(g.total-e),y.set("1",g.total-e),g.total-e==0&&y.has("1")&&y.delete("1");i(document.querySelector("#recibio").value)}(),l.showModal(),document.addEventListener("click",r)}),null==u||u.addEventListener("click",()=>{c.showModal(),document.addEventListener("click",r)}),p.forEach(e=>{e.addEventListener("change",e=>{var t;null===(t=document.querySelector("#productsInv"))||void 0===t||t.classList.toggle("hidden"),"1"===e.target.value?document.querySelectorAll(".inputInv").forEach(e=>e.setAttribute("required","")):document.querySelectorAll(".inputInv").forEach(e=>e.removeAttribute("required"))})}),f.forEach(e=>{e.addEventListener("input",e=>{var t,o;const n=e.target;n.value!=(null===(t=n.parentElement)||void 0===t?void 0:t.dataset.qty)?(n.classList.add("border-2","border-rose-600"),document.querySelector(".alerta")||msjAlert("error","Cantidad diferente a devolver a inventario",document.querySelector("#divmsjalerta1"))):(n.classList.remove("border-2","border-rose-600"),null===(o=document.querySelector(".alerta"))||void 0===o||o.remove())})}),v.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;v.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=g.total?(y.set("1",g.total-o),g.total-o==0&&y.has("1")&&y.delete("1"),y.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&y.has(e.target.id)&&y.delete(e.target.id)):y.has(e.target.id)?e.target.value=y.get(e.target.id).toLocaleString():e.target.value="0";v[0].value=null!==(t=y.get("1"))&&void 0!==t?t:0,i(document.querySelector("#recibio").value)}(e)})}),null===(n=document.querySelector("#recibio"))||void 0===n||n.addEventListener("input",e=>{i(e.target.value)}),null===(a=document.querySelector("#formfacturar"))||void 0===a||a.addEventListener("submit",e=>{e.preventDefault(),function(e){__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("id",document.querySelector("#idorden").dataset.idorden),t.append("idcaja",s.value),t.append("idconsecutivo",m.value),t.append("caja",document.querySelector("#caja option:checked").textContent),t.append("tipofacturador",m.options[m.selectedIndex].textContent),t.append("mediosPago",JSON.stringify(Array.from(y,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),t.append("recibido",document.querySelector("#recibio").value),t.append("transaccion",""),t.append("estado",e),t.append("cambioaventa","1"),t.append("observacion",document.querySelector("#observacion").value);try{const e="/admin/api/facturarCotizacion",o=yield fetch(e,{method:"POST",body:t}),n=yield o.json();console.log(n),void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),function(){d&&(d.style.display="none");document.querySelector("#abrirOrden").style.display="none",document.querySelector("#estadoOrden").textContent="Paga"}()):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}l.close(),document.removeEventListener("click",r)}))}("Paga")})}})(),function(){var e,t;if(document.querySelector(".reportes")){const n=null===(e=document.getElementById("chartventas"))||void 0===e?void 0:e.getContext("2d"),a=null===(t=document.getElementById("chartutilidad"))||void 0===t?void 0:t.getContext("2d"),i=document.querySelector("#ventasgenerales"),r=document.querySelector("#cierrescaja"),l=(document.querySelector("#modalFecha"),{inicio:"",fin:""});function o(e){Swal.fire({title:"<strong>Seleccionar <u>Fecha</u></strong>",html:'\n        <div class="campodaterange">\n          <label class="formulario__label" for="fechapersonalizada">Fecha personalizada</label>\n          <input type="text" name="daterange" class="formulario__input" id="fechapersonalizada" /></div>\n        ',showCloseButton:!0,showCancelButton:!0,focusConfirm:!1,width:"auto"}).then(t=>{t.isConfirmed&&""!=l.inicio&&""!=l.fin&&(window.location.href=`/admin/reportes/${e}?inicio=${l.inicio}&fin=${l.fin}`)})}new Chart(n,{type:"bar",data:{labels:["Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange"],datasets:[{label:"Total Ventas",data:[12,19,3,5,2,3],borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}},responsive:!0}}),new Chart(a,{type:"doughnut",data:{labels:["Ventas total:","Costo:","Utilidad:"],datasets:[{label:"Total Ventas",data:[19,7,12],backgroundColor:["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 205, 86)"],hoverOffset:4}]},options:{responsive:!0}}),$('input[name="daterange"]').daterangepicker({opens:"right",alwaysShowCalendars:!0}),null==i||i.addEventListener("click",()=>{l.inicio="",l.fin="",o("ventasgenerales"),$('input[name="daterange"]').daterangepicker({opens:"right",alwaysShowCalendars:!0}),$('input[name="daterange"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD"),n=t.endDate.format("YYYY-MM-DD");l.inicio=o,l.fin=n}))}),r.addEventListener("click",()=>{l.inicio="",l.fin="",o("cierrescaja"),$('input[name="daterange"]').daterangepicker(),$('input[name="daterange"]').on("apply.daterangepicker",(function(e,t){l.inicio=t.startDate.format("YYYY-MM-DD"),l.fin=t.endDate.format("YYYY-MM-DD")}))})}}();
//# sourceMappingURL=bundle.ts.js.map
